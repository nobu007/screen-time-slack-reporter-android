# PR-003: Java Toolchain設定（環境互換性問題解消）

**優先度**: High  
**カテゴリ**: Environment  
**関連Gap**: GAP-005  
**関連Issue**: ISS-005  

## 問題

Java 24環境でGradle 8.13/AGPとの互換性問題により、`./gradlew test` が実行できない。

**根拠**:
- `execution/feedback_to_auditor.yml:ISS-NEW-003`
- 15_executor実行時に実際に問題発生

## 提案内容

`gradle.properties` に Java toolchain設定を追加し、Java 17を使用するように指定する。

## 変更内容

### gradle.properties

```properties
# 既存の設定に追加
org.gradle.jvmargs=-Xmx2048m -Dfile.encoding=UTF-8
android.useAndroidX=true
android.enableJetifier=false

# Java toolchain設定を追加
org.gradle.java.home=/path/to/jdk-17
# または
kotlin.jvm.target.validation.mode=warning
```

**代替案**: `app/build.gradle.kts` でtoolchainを明示的に設定

```kotlin
kotlin {
    jvmToolchain(17)
}
```

## 期待効果

- ✅ Java 24環境でも `./gradlew test` が実行可能になる
- ✅ CI/CDでの互換性問題を回避
- ✅ 開発環境の統一性向上

## 検証方法

```bash
# Java 24環境で実行
./gradlew clean test --info
```

**成功条件**: テストが正常に実行され、エラーが発生しない

## リスクと副作用

- **低リスク**: Java 17は安定版であり、Android開発で広く使用されている
- **注意点**: チーム全員がJava 17 JDKをインストールする必要がある

## ロールバック手順

```bash
# gradle.propertiesから追加した行を削除
git checkout gradle.properties
```

## 実装順序

1. `gradle.properties` に toolchain設定を追加
2. `./gradlew clean test` で動作確認
3. CI/CD設定でもJava 17を指定（PR-002と連携）

## 参考資料

- [Gradle Toolchains](https://docs.gradle.org/current/userguide/toolchains.html)
- [Android Gradle Plugin Release Notes](https://developer.android.com/build/releases/gradle-plugin)
